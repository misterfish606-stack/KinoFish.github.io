<script>
// ===== –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –æ—Ç–≤–µ—Ç–∞–º–∏ =====
let comments = JSON.parse(localStorage.getItem("cinemaComments")) || [];

function renderComments() {
  const container = document.getElementById('commentList');
  container.innerHTML = '';
  comments.forEach((c,index)=>{
    let div = document.createElement('div');
    div.className = "comment";
    div.innerHTML = `
      <img class="avatar" src="https://i.imgur.com/7y9E9Hl.png">
      <b>${c.name}</b>: ${c.text}<br>
      <button onclick="like(${index})">üëç ${c.likes}</button>
      <button onclick="dislike(${index})">üëé ${c.dislikes}</button>
      <button onclick="reply(${index})">üí¨ –û—Ç–≤–µ—Ç–∏—Ç—å</button>
      <div class="replies" id="replies-${index}" style="margin-left:20px;"></div>
    `;
    container.appendChild(div);

    // –†–µ–Ω–¥–µ—Ä–∏–º –æ—Ç–≤–µ—Ç—ã
    if(c.replies){
      c.replies.forEach((r,ri)=>{
        let rdiv = document.createElement('div');
        rdiv.className="comment";
        rdiv.style.background="#220000";
        rdiv.style.marginTop="5px";
        rdiv.innerHTML=`<img class="avatar" src="https://i.imgur.com/7y9E9Hl.png"><b>${r.name}</b>: ${r.text}`;
        document.getElementById(`replies-${index}`).appendChild(rdiv);
      });
    }
  });
}

function addComment(){
  let name = document.getElementById("username").value.trim();
  let text = document.getElementById("commentInput").value.trim();
  if(!name || !text) return;
  comments.push({name,text,likes:0,dislikes:0,replies:[]});
  localStorage.setItem("cinemaComments",JSON.stringify(comments));
  renderComments();
  document.getElementById("commentInput").value='';
}

// –õ–∞–π–∫–∏/–¥–∏–∑–ª–∞–π–∫–∏
function like(index){comments[index].likes++; saveAndRender();}
function dislike(index){comments[index].dislikes++; saveAndRender();}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä
function saveAndRender(){
  localStorage.setItem("cinemaComments",JSON.stringify(comments));
  renderComments();
}

// –û—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
function reply(index){
  let replyText = prompt("–í–∞—à –æ—Ç–≤–µ—Ç:");
  let replyName = prompt("–í–∞—à–µ –∏–º—è:");
  if(!replyText || !replyName) return;
  if(!comments[index].replies) comments[index].replies=[];
  comments[index].replies.push({name:replyName,text:replyText});
  saveAndRender();
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
renderComments();
</script>
