<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–•–æ—Ä–æ—à–∏–π, –ø–ª–æ—Ö–æ–π, –∑–ª–æ–π (1966)</title>

<style>
body{margin:0;font-family:'Arial Black',sans-serif;background:#1b0000;color:#eee;overflow-x:hidden;}
.wrapper{width:70%;margin:0 auto;padding-bottom:60px;}
.slider{position:relative;margin-top:20px;overflow:hidden;border-radius:10px;height:200px;background:#220000;padding:10px;box-shadow:0 0 15px #900;}
.slides{display:flex;transition:0.5s;}
.slides img{width:300px;margin-right:15px;border-radius:5px;cursor:pointer;transition:0.3s;}
.slides img:hover{transform:scale(1.05);}
.prev,.next{position:absolute;top:50%;transform:translateY(-50%);background:#330000;border:none;color:white;font-size:20px;padding:8px;cursor:pointer;border-radius:5px;}
.prev{left:5px;} .next{right:5px;}
.top{display:flex;gap:30px;margin-top:30px;}
.poster img{width:250px;border-radius:10px;box-shadow:0 0 20px #900;}
.info-block{display:flex;flex-direction:column;justify-content:flex-start;}
.description{margin-top:30px;line-height:1.6;padding:15px;background:#220000;border-radius:10px;box-shadow:0 0 15px #900;}
.video-container{margin-top:30px;}
.video-container iframe{width:100%;height:500px;border-radius:10px;box-shadow:0 0 25px #900;}
button{padding:6px 10px;background:#330000;color:white;border:1px solid #aa0000;border-radius:5px;cursor:pointer;margin-top:5px;font-size:12px;}
button:hover{background:#660000;}
.star{font-size:24px;color:#550000;cursor:pointer;}
.star.selected{color:gold;}
#avgRating{font-size:18px;color:gold;margin-top:10px;}
.comment{background:#140000;padding:10px;margin-top:10px;border-left:4px solid #aa0000;border-radius:5px;position:relative;}
.reply{margin-left:40px;background:#1f0000;border-left:4px solid #ff4444;}
.reply-level-2{margin-left:80px;background:#260000;border-left:4px solid #ffaa00;}
.comment-buttons{position:absolute;top:5px;right:5px;}
.comment-buttons button{margin-left:5px;padding:2px 5px;font-size:12px;}
</style>
</head>
<body>
<div class="wrapper">

<h2>–•–æ—Ä–æ—à–∏–π, –ø–ª–æ—Ö–æ–π, –∑–ª–æ–π (1966)</h2>

<div class="slider">
  <div class="slides" id="slides">
    <img src="https://upload.wikimedia.org/wikipedia/en/4/45/Good_the_bad_and_the_ugly_poster.jpg">
    <img src="https://m.media-amazon.com/images/I/91z+4nW6zRL._AC_SL1500_.jpg">
    <img src="https://upload.wikimedia.org/wikipedia/commons/2/22/The_Good_the_Bad_and_the_Ugly.jpg">
  </div>
  <button class="prev" onclick="moveSlide(-1)">‚ùÆ</button>
  <button class="next" onclick="moveSlide(1)">‚ùØ</button>
</div>

<div class="top">
  <div class="poster">
    <img src="https://i.imgur.com/XKxOxxg.jpg">
  </div>
  <div class="info-block">
    <p><b>–ü—Ä–æ—Å–º–æ—Ç—Ä—ã:</b> <span id="viewCount">0</span></p>
  </div>
</div>

<div class="description">–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä—ë—Ö –æ—Ö–æ—Ç–Ω–∏–∫–æ–≤ –∑–∞ —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∞ –ì—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–π –≤–æ–π–Ω—ã –≤ –°–®–ê.</div>

<div class="video-container">
  <iframe src="https://www.youtube.com/embed/0Bwxz16-T04" allowfullscreen></iframe>
</div>

<h3>–í—Ö–æ–¥</h3>
<input type="text" id="loginName" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
<button onclick="login()">–í–æ–π—Ç–∏</button>
<p id="currentUser"></p>

<h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
<input type="text" id="commentInput" placeholder="–í–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π">
<button id="sendComment">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
<div id="commentList"></div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
// ===== –ü–†–û–°–ú–û–¢–†–´ (—Å–±—Ä–æ—à–µ–Ω—ã –¥–æ 0 –∏ –Ω–µ –Ω–∞–∫—Ä—É—á–∏–≤–∞—é—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ) =====
const viewKey = "film_view_count";
if(!localStorage.getItem(viewKey)){
  localStorage.setItem(viewKey, "0");
}
document.getElementById("views").innerText = localStorage.getItem(viewKey);

// ===== –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ò =====
let comments = JSON.parse(localStorage.getItem("comments") || "[]");

function saveComments(){
  localStorage.setItem("comments", JSON.stringify(comments));
}

function renderComments(){
  const container = document.getElementById("commentList");
  container.innerHTML = "";
  comments.forEach(c => container.appendChild(createCommentElement(c)));
}

function createCommentElement(comment, level = 0){
  const div = document.createElement("div");
  div.className = "comment";
  div.style.marginLeft = (level * 30) + "px";

  div.innerHTML = `
    <div class="comment-header">
      <strong>${comment.author}</strong>
      <div class="menu">
        <button onclick="toggleMenu('${comment.id}')">‚ãÆ</button>
        <div class="menu-content" id="menu-${comment.id}"></div>
      </div>
    </div>
    <p>${comment.text}</p>
    <div class="actions">
      <button onclick="like('${comment.id}')">üëç <span>${comment.likes}</span></button>
      <button onclick="dislike('${comment.id}')">üëé <span>${comment.dislikes}</span></button>
    </div>
    <div class="replies" id="replies-${comment.id}"></div>
  `;

  const repliesContainer = div.querySelector(`#replies-${comment.id}`);
  if(comment.replies){
    comment.replies.forEach(r => repliesContainer.appendChild(createCommentElement(r, level + 1)));
  }

  return div;
}

function toggleMenu(id){
  document.querySelectorAll(".menu-content").forEach(m => m.innerHTML = "");
  const menu = document.getElementById("menu-" + id);
  const comment = findComment(id);

  if(comment.author === "You"){
    menu.innerHTML = `<button onclick="deleteComment('${id}')">–£–¥–∞–ª–∏—Ç—å</button>`;
  } else {
    menu.innerHTML = `<button onclick="replyTo('${id}')">–û—Ç–≤–µ—Ç–∏—Ç—å</button>`;
  }
}

function findComment(id, list = comments){
  for(let c of list){
    if(c.id === id) return c;
    if(c.replies){
      const found = findComment(id, c.replies);
      if(found) return found;
    }
  }
  return null;
}

function like(id){
  const c = findComment(id);
  c.likes++;
  saveComments();
  renderComments();
}

function dislike(id){
  const c = findComment(id);
  c.dislikes++;
  saveComments();
  renderComments();
}

function replyTo(id){
  const text = prompt("–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç:");
  if(!text) return;
  const parent = findComment(id);
  const reply = {
    id: Date.now().toString(),
    author: "You",
    text,
    likes: 0,
    dislikes: 0,
    replies: []
  };
  parent.replies = parent.replies || [];
  parent.replies.push(reply);
  saveComments();
  renderComments();

  setTimeout(() => {
    const el = document.getElementById(`replies-${id}`);
    if(el) el.scrollIntoView({behavior:"smooth"});
  }, 100);
}

function deleteComment(id, list = comments){
  for(let i = 0; i < list.length; i++){
    if(list[i].id === id){
      list.splice(i,1);
      saveComments();
      renderComments();
      return true;
    }
    if(list[i].replies && deleteComment(id, list[i].replies)){
      return true;
    }
  }
  return false;
}

function addComment(){
  const input = document.getElementById("commentInput");
  if(!input.value.trim()) return;
  comments.push({
    id: Date.now().toString(),
    author: "You",
    text: input.value,
    likes: 0,
    dislikes: 0,
    replies: []
  });
  input.value = "";
  saveComments();
  renderComments();
}

renderComments();
</script>
</div>
</body>
</html>


